<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>InternsHub - Login</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Tailwind config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              orange: "#D9653F",
              black: "#0F0F0F",
              gray: "#F1F3F5"
            }
          },
          boxShadow: {
            soft: "0 8px 30px rgba(0,0,0,0.08)"
          },
          fontFamily: {
            sans: ['Inter', 'ui-sans-serif', 'system-ui', 'Segoe UI', 'Helvetica Neue', 'Arial']
          }
        }
      }
    }
  </script>

  <!-- Inter font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow-x: hidden;
    }

    .oval-ring::after {
      content: "";
      position: absolute;
      inset: -10px -18px -8px -18px;
      border: 3px solid #D9653F;
      border-radius: 50%;
      transform: rotate(-8deg);
      pointer-events: none;
    }

    /* Hand-drawn sketch lines */
    .hand-lines {
      background-image: repeating-linear-gradient(
        0deg,
        rgba(0,0,0,0.3) 0px,
        rgba(0,0,0,0.3) 2px,
        transparent 2px,
        transparent 8px
      );
    }

    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Squiggle decoration */
    .squiggle {
      font-size: 20px;
      line-height: 1;
    }

    /* Mobile menu styles */
    .mobile-menu {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      z-index: 50;
      padding: 2rem;
    }

    .mobile-menu.active {
      display: block;
    }
  </style>
</head>
<body class="font-sans text-brand-black antialiased bg-brand-gray flex flex-col">

  <!-- Top navigation -->
  <header class="w-full flex-shrink-0">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 pt-4 sm:pt-5">
      <div class="flex items-center justify-between">
        <!-- Left group -->
        <div class="flex items-center gap-3 sm:gap-6">
          <!-- Logo + email -->
          <div class="flex items-center gap-2 sm:gap-3">
          <img 
            src="Images/Community logo.1.png" 
            alt="icon" 
            class="w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-black/90 grid place-items-center text-white text-xs font-bold object-cover"
          />
            <a href="mailto:hello@job.io" class="hidden sm:block text-sm text-black/70 hover:text-black">Elevana</a>
          </div>

          <!-- Middle links - Desktop -->
          <nav class="hidden lg:flex items-center gap-4 xl:gap-6 text-sm text-black/70">
            <a href="#" class="hover:text-black">Top Job</a>
            <a href="#" class="hover:text-black">Resume</a>
            <a href="#" class="hover:text-black">Event</a>
          </nav>
        </div>

        <!-- Right group -->
        <div class="flex items-center gap-2 sm:gap-3">
          <a href="signup.html" class="hidden sm:block text-sm text-black/70 hover:text-black">Sign Up</a>
          <a href="signup.html" class="text-xs sm:text-sm bg-black text-white px-3 sm:px-4 py-2 rounded hover:bg-black/90">Join Now</a>
          <button id="menuToggle" class="lg:hidden w-9 h-9 grid place-items-center border border-black/10 rounded">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-width="2" stroke-linecap="round" d="M4 7h16M4 12h16M4 17h16"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Menu -->
  <div id="mobileMenu" class="mobile-menu">
    <div class="flex justify-between items-center mb-8">
      <div class="text-xl font-bold">Menu</div>
      <button id="closeMenu" class="w-9 h-9 grid place-items-center border border-black/10 rounded">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-width="2" stroke-linecap="round" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>
    <nav class="flex flex-col gap-4 text-lg">
      <a href="#" class="hover:text-brand-orange">Home</a>
      <a href="#" class="hover:text-brand-orange">Rules</a>
      <a href="#" class="hover:text-brand-orange"></a>
      <a href="#" class="hover:text-brand-orange">Sign Up</a>
      <a href="mailto:hello@job.io" class="hover:text-brand-orange">hello@job.io</a>
    </nav>
  </div>

  <!-- Split hero - Flex grow to fill screen -->
  <section class="flex-grow flex items-center py-4 sm:py-6">
    <div class="w-full max-w-7xl mx-auto px-4 sm:px-6">
      <div class="grid lg:grid-cols-2 rounded-lg overflow-hidden h-full min-h-[500px] lg:min-h-[600px]">

        <!-- Left panel - Login Form -->
        <div class="bg-brand-gray p-6 sm:p-8 lg:p-12 flex flex-col justify-center">
          <div id="alreadySignedIn" class="hidden mb-4 p-3 border border-emerald-300 bg-emerald-50 rounded text-sm text-emerald-800 flex items-center justify-between gap-2">
            <span id="signedInText">You're already signed in.</span>
            <div class="flex items-center gap-2">
              <a id="goDashboard" href="Dashboard.html" class="px-3 py-1.5 rounded bg-emerald-600 text-white text-xs">Go to Dashboard</a>
              <button id="switchAccount" class="px-3 py-1.5 rounded border border-emerald-600 text-emerald-700 text-xs bg-white">Switch account</button>
            </div>
          </div>
          <!-- Breadcrumb -->
          <div class="text-xs sm:text-sm text-black/60 mb-4 sm:mb-6">Login to Your Account</div>

          <!-- Headline -->
          <h1 class="text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-extrabold leading-tight text-black">
            Welcome
            <span class="relative inline-block ">Back!</span>
          </h1>

          <!-- Subcopy -->
          <p class="mt-3 sm:mt-4 text-sm sm:text-base text-black/70 max-w-xl">
            Sign in to access your <span class="font-semibold text-black">Internship Dashboard</span> and explore new opportunities.
          </p>

          <!-- Login Form -->
          <form class="mt-6 sm:mt-8 space-y-4" onsubmit="handleLogin(event)">
            

            <!-- Email -->
            <div>
              <label for="email" class="block text-sm font-medium text-black/80 mb-1.5">Email</label>
              <input 
                type="email" 
                id="email" 
                name="email"
                placeholder="Enter your email"
                required
                class="w-full px-4 py-2.5 border-2 border-black/20 rounded-md text-sm focus:outline-none focus:border-black transition"
              />
              <p id="errorEmail" class="mt-1 text-xs text-red-600 hidden">Enter a valid email address.</p>
            </div>

            

            <!-- Password -->
            <div>
              <label for="password" class="block text-sm font-medium text-black/80 mb-1.5">Password</label>
              <div class="relative">
                <input 
                  type="password" 
                  id="password" 
                  name="password"
                  placeholder="Enter your password"
                  required
                  class="w-full px-4 py-2.5 pr-12 border-2 border-black/20 rounded-md text-sm focus:outline-none focus:border-black transition"
                />
                <button 
                  type="button"
                  id="togglePassword"
                  class="absolute right-3 top-1/2 -translate-y-1/2 text-black/50 hover:text-black transition"
                  aria-label="Toggle password visibility"
                >
                  <!-- Eye Icon (hidden by default) -->
                  <svg id="eyeIcon" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3" stroke-width="2"/>
                  </svg>
                  <!-- Eye-off Icon (visible by default) -->
                  <svg id="eyeOffIcon" class="w-5 h-5 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"/>
                    <line x1="1" y1="1" x2="23" y2="23" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </button>
              </div>
              <p id="errorPassword" class="mt-1 text-xs text-red-600 hidden">Password must be at least 8 characters.</p>
            </div>

            <!-- Login Button -->
            <button
              type="submit"
              class="w-full inline-flex items-center justify-center gap-2 sm:gap-3 border-2 border-black bg-black text-white px-4 sm:px-5 py-2.5 sm:py-3 rounded-md text-sm sm:text-base font-medium hover:bg-brand-orange hover:border-brand-orange transition"
            >
              Login
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
              </svg>
            </button>
          </form>

          <!-- Additional Links -->
          <div class="mt-6 flex flex-col sm:flex-row items-center justify-between gap-3 text-sm">
            <a href="#" class="text-black/70 underline underline-offset-4 hover:text-black">Forgot Password?</a>
            <a href="signup.html" class="text-black/70 hover:text-black">Don't have an account? <span class="font-semibold underline">Sign Up</span></a>
          </div>
        </div>

      <!-- Right panel -->
      <div class="relative bg-brand-orange text-black overflow-hidden min-h-[400px] lg:min-h-0">
        <div class="h-full w-full p-6 sm:p-8 lg:p-12 relative flex flex-col">
          <!-- Hands illustration -->
          <img src="Images/relaxxxx.png" alt="Hands illustration" class="absolute bottom-0 left-0 right-0 w-full h-auto" />
        </div>
      </div>
      </div>
      <br>
    </div>
  </section>

  <script>
    // Password toggle functionality
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('password');
    const eyeIcon = document.getElementById('eyeIcon');
    const eyeOffIcon = document.getElementById('eyeOffIcon');

    if (togglePassword) {
      togglePassword.addEventListener('click', () => {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        
        // Toggle icon visibility
        eyeIcon.classList.toggle('hidden');
        eyeOffIcon.classList.toggle('hidden');
      });
    }

    // Mobile menu toggle
    const menuToggle = document.getElementById('menuToggle');
    const closeMenu = document.getElementById('closeMenu');
    const mobileMenu = document.getElementById('mobileMenu');

    if (menuToggle) {
      menuToggle.addEventListener('click', () => {
        mobileMenu.classList.add('active');
      });
    }

    if (closeMenu) {
      closeMenu.addEventListener('click', () => {
        mobileMenu.classList.remove('active');
      });
    }

    // Close mobile menu when clicking on a link
    const mobileLinks = mobileMenu.querySelectorAll('a');
    mobileLinks.forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu.classList.remove('active');
      });
    });

    // Validation helpers
    function hide(el){ if(el){ el.classList.add('hidden'); } }
    function show(el){ if(el){ el.classList.remove('hidden'); } }
    function validateEmail(email){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email); }
    function validateInternId(id){ return id === '' || /^[a-zA-Z0-9]{3,20}$/.test(id); }
    // Password hashing with fallback when crypto.subtle is unavailable (e.g., file://)
    async function hashPassword(text){
      try {
        if (window.crypto && window.crypto.subtle) {
          const data = new TextEncoder().encode(text);
          const hash = await window.crypto.subtle.digest('SHA-256', data);
          return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2,'0')).join('');
        }
      } catch {}
      // Fallback: FNV-1a 32-bit hex (not cryptographically secure; used only to avoid runtime errors offline)
      let h = 0x811c9dc5;
      for (let i = 0; i < text.length; i++) {
        h ^= text.charCodeAt(i);
        h = (h + ((h << 1) + (h << 4) + (h << 7) + (h << 8) + (h << 24))) >>> 0;
      }
      return ('00000000' + h.toString(16)).slice(-8);
    }

    // Session helpers
    function setSession(session) {
      localStorage.setItem('interns_session', JSON.stringify(session));
    }
    function addLoginLog(entry){
      try {
        const key = 'interns_login_logs';
        const logs = JSON.parse(localStorage.getItem(key) || '[]');
        logs.push(entry);
        // keep only recent 500 entries to avoid unlimited growth
        const trimmed = logs.slice(-500);
        localStorage.setItem(key, JSON.stringify(trimmed));
      } catch {}
    }
    function getUsers() {
      try { return JSON.parse(localStorage.getItem('interns_users') || '[]'); } catch { return []; }
    }
    function redirectIfAuthenticated() {
      // Allow forcing the login form to show using ?force=true
      const params = new URLSearchParams(window.location.search);
      if (params.get('force') === 'true') return;

      const sessionRaw = localStorage.getItem('interns_session');
      if (!sessionRaw) return;
      try {
        const session = JSON.parse(sessionRaw);
        if (!session || !session.userId) return;
        const users = getUsers();
        const user = users.find(u => u.id === session.userId);
        if (user) {
          // Show inline prompt instead of redirecting
          const box = document.getElementById('alreadySignedIn');
          const text = document.getElementById('signedInText');
          const switchBtn = document.getElementById('switchAccount');
          if (text && user.fullName) text.textContent = `You're already signed in as ${user.fullName}.`;
          if (box) box.classList.remove('hidden');
          if (switchBtn) {
            switchBtn.addEventListener('click', function(){
              localStorage.removeItem('interns_session');
              window.location.href = 'login.html?force=true';
            });
          }
        } else {
          // Clean up stale session if user is missing
          localStorage.removeItem('interns_session');
        }
      } catch {
        // Corrupt session; remove it
        localStorage.removeItem('interns_session');
      }
    }
    redirectIfAuthenticated();

    // Handle login form submission (client-side auth)
    async function handleLogin(event) {
      event.preventDefault();
      const email = document.getElementById('email').value.trim().toLowerCase();
      const password = document.getElementById('password').value;

      // Clear errors
      hide(document.getElementById('errorEmail'));
      hide(document.getElementById('errorPassword'));

      // Validate inputs (allow login via either internId or email)
      let hasError = false;
      if (!validateEmail(email)) { show(document.getElementById('errorEmail')); hasError = true; }
      if (!password || password.length < 8) { show(document.getElementById('errorPassword')); hasError = true; }
      if (hasError) { return; }

      // Fixed admin credentials (no security)
      if (email === 'admin@innerwhispers.in' && password === 'Innerwhispers@123') {
        try {
          const users = getUsers();
          let adminUser = users.find(u => u.id === 'admin');
          if (!adminUser) {
            adminUser = {
              id: 'admin',
              fullName: 'Administrator',
              email: 'admin@admin.com'
            };
            users.push(adminUser);
            localStorage.setItem('interns_users', JSON.stringify(users));
          }
          setSession({ userId: 'admin', loginAt: new Date().toISOString() });
          addLoginLog({
            userId: 'admin',
            name: 'Administrator',
            email: 'admin@admin.com',
            role: 'admin',
            loginAt: new Date().toISOString()
          });
        } catch {}
        window.location.href = 'Admin Dashboard/Admin-dashbaord.html';
        return;
      }

      const users = getUsers();
      const passwordHash = await hashPassword(password);
      const user = users.find(u => (u.email === email) && u.passwordHash === passwordHash);
      if (!user) {
        alert('Invalid credentials. Please check your details or sign up.');
        return;
      }

      const session = {
        userId: user.id,
        loginAt: new Date().toISOString()
      };
      setSession(session);
      addLoginLog({
        userId: user.id,
        name: user.fullName || 'User',
        email: user.email || email,
        role: 'user',
        loginAt: session.loginAt
      });
      window.location.href = 'Dashboard.html';
    }

    // Add hover effect to buttons
    const ctaButtons = document.querySelectorAll('button[type="submit"]');
    ctaButtons.forEach(btn => {
      btn.addEventListener('mouseenter', () => btn.classList.add('scale-[1.02]'));
      btn.addEventListener('mouseleave', () => btn.classList.remove('scale-[1.02]'));
    });
  </script>
</body>
</html>